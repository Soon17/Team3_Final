<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{layout/layout.html}" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
   <meta charset="UTF-8">
   <title>ì¹´ëª¨ì•„ - êµ­ë‚´ë„ í•´ì™¸ë„ ë ŒíŠ¸ì¹´</title>
   <!-- <script
   src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=ad16376e4af261fc1e62afc32792b67a&libraries=services,clusterer,drawing"></script> -->
   <style>
      .marker-title-div{
         border-radius: 20px;
      }
      .hotel-map-datail {
         position: relative;
         overflow: hidden;
         user-select: none;
         -webkit-user-drag: none;
         left: 0px;
         top: 0px;
         width: 100%;
         height: 500px;
         z-index: 0;

      }

      .calendar-wrapper {
         background: white;
         max-width: 700px;
         margin: auto;
         padding: 20px;
         border-radius: 15px;
         box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      .modal-header {
         margin-bottom: 20px;
         font-size: 18px;
         font-weight: bold;
         display: flex;
         justify-content: space-between;
         align-items: center;
      }

      .calendar-grid {
         display: grid;
         grid-template-columns: 1fr;
         gap: 30px;
         max-height: 600px;
         overflow-y: auto;
         padding-right: 10px;
      }

      .month {
         border: 1px solid #ddd;
         border-radius: 10px;
         padding: 10px;
         background: #fff;
      }

      .month h3 {
         text-align: center;
         margin: 0 0 10px;
      }

      .days {
         display: grid;
         grid-template-columns: repeat(7, 1fr);
         gap: 5px;
      }

      .day,
      .day-name {
         text-align: center;
         padding: 8px 0;
      }

      .day:hover {
         cursor: pointer;
      }

      .day-name {
         font-weight: bold;
         background-color: #f8f8f8;
      }

      .day.disabled {
         color: #ccc;
         cursor: not-allowed;
      }

      .day.selected {
         background-color: #007aff;
         color: white;
         border-radius: 10px;
      }

      .day.in-range {
         background-color: rgba(0, 122, 255, 0.3);
         border-radius: 10px;
      }

      .apply-btn {
         width: 100%;
         padding: 15px;
         background-color: #007aff;
         color: white;
         font-size: 16px;
         border: none;
         margin-top: 20px;
         border-radius: 10px;
         cursor: pointer;
      }

      .main-container {
         background-color: #f5f6f7;
         font-family: 'Noto Sans KR', sans-serif;
         width: 100%;
         padding: 0;
      }

      .row {
         max-width: 1032px;
         display: flex;
         flex-wrap: wrap;
         justify-content: space-between;
         margin: 0px auto;
         padding-top: 40px;
         padding-bottom: 100px;
      }

      .search-bar-wrap {
         width: 100%;
         background-color: #fff;
         border-bottom: 1px solid #eee;
         position: sticky;
         top: 0;
         z-index: 1000;
         transition: transform 0.3s ease;
         background-color: white;
         overflow: hidden;
      }

      .search-bar-inner {
         padding: 10px 0;
         display: flex;
         gap: 20px;
         height: 80px;
         align-items: center;
         box-sizing: border-box;
         cursor: pointer;
         justify-content: center;
      }

      .search-input {
         width: 300px;
         padding: 12px 16px;
         background-color: #f8f8f8;
         border: 1px solid #ddd;
         border-radius: 5px;
         font-size: 14px;
         font-weight: bold;
      }

      .search-btn {
         padding: 12px 20px;
         background-color: #007bff;
         color: white;
         border: none;
         border-radius: 5px;
         cursor: pointer;
         font-weight: 600;
      }

      .search-box-area {
         width: 100%;
         max-width: 330px;
         margin-right: 20px;
         position: fixed;
         transition: transform 0.3s ease;
         top: 0;
      }


      .container-box {
         background-color: #f5f6f7;
         border-radius: 10px;
         width: 100%;
         max-width: 680px;
         padding-right: 0;
      }

      .sort-options {
         display: flex;
         gap: 16px;
         background: white;
         padding: 5px 15px;
         border-radius: 30px;
         justify-content: flex-end;
      }

      .sort-options label {
         display: flex;
         align-items: center;
         cursor: pointer;
         font-size: 14px;
         color: #666;
         font-weight: 400;
         font-size: 12px;
         margin: 0;
      }

      .sort-options input[type="radio"] {
         appearance: none;
         width: 12px;
         height: 12px;
         border: 2px solid #ccc;
         border-radius: 50%;
         margin-right: 2px;
         cursor: pointer;
      }

      .sort-options input[type="radio"]:checked::before {
         content: '';
         display: block;
         width: 100%;
         height: 100%;
         background-color: #4564b8;
         border-radius: 50%;
      }

      .card-link {
         display: flex;
         text-decoration: none;
         color: inherit;
         padding: 20px 15px;
         background-color: #ffffff73;
         width: 100%;
         justify-content: space-between;
      }

      .hotel-location {
         color: #0d6ffc;
         font-size: .75rem;
      }

      .poto {
         border-radius: 5px;
         height: 208px;
         width: 272px;

      }

      .price {
         color: #9f1f13;
         font-size: 20px;
      }


      .hotel-price {
         align-self: flex-end;
         font-weight: bold;
         font-size: 15px;
         margin-top: auto;
      }

      .hotel-info {
         display: flex;
         flex-direction: column;
         justify-content: space-between;
         height: 100%;
         padding: 10px 30px;
         padding-top: 0px !important;
         max-width: 400px;
         width: 100%;
      }

      .hotel-up {
         display: flex;
         flex-direction: column;
         align-items: flex-start;
         margin-right: 100px;
      }

      .hotel-grade {
         display: flex;
         gap: 4px;
         align-items: flex-start;
         flex-direction: row;
      }

      .card-link:hover {
         color: inherit !important;
         text-decoration: none !important;
      }

      .mobile-header {
         display: none;
         padding: 16px;
         background: #fff;
         font-size: 14px;
         border-bottom: 1px solid #eee;
         flex-direction: column;
         gap: 4px;
      }

      .im {
         display: flex;
         justify-content: center;
      }

      .star {
         width: 16px;
         height: 16px;
      }

      .hotel-stars {
         font-size: 12px;
      }

      .hotel-name {
         font-weight: bold;
      }

      .review-score {
         font-size: 12px;
      }

      .mobile-sort-bar {
         display: none;
      }

      @media screen and (max-width: 1080px) {
         header {
            display: none;
         }

         .search-bar-wrap {
            display: none;
         }

         div.d-flex.justify-content-between.align-items-center.mb-2 {
            display: none !important;
         }

         .mobile-header {
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 10px 30px;
            align-items: center;
            font-size: 14px;
         }

         .row {
            align-content: center;
            flex-direction: column;
            padding-top: 10px !important;
         }

         .container-box {
            margin-top: 10px;
            max-width: 970px !important;
            width: 100% !important;
         }

         .hotel-info {
            max-width: 800px !important;
            width: 100%;
            padding: 0px 15px !important;
         }

         .search-box-area {
            display: none;
         }

         .poto {
            width: 272px;
            height: 208px;
         }

         .mobile-sort-bar {
            position: sticky;
            top: 0;
            z-index: 999;
            transition: transform 0.3s ease;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start;
            padding: 10px 30px;
            background-color: #fff;
            font-size: 12px;
         }

         .mobile-sort-bar button,
         .mobile-sort-bar select {
            padding: 6px 10px;
            font-size: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: #fff;
            white-space: nowrap;
            margin-bottom: 10px;
         }

         .mobile-sort-bar .toggle-area {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            margin-left: auto;
         }

         .mobile-sort-bar .count {
            font-size: 12px;
            color: #555;
         }

      }

      @media screen and (max-width: 720px) {
         .card-link {
            display: flex;
            flex-direction: column;
         }

         .poto {
            max-width: 650px !important;
            max-height: 250px !important;
            height: 100%;
            width: 100%;
         }

         .hotel-info {
            padding: 10px 0px !important;
         }

      }

      .counter-header {
         font-size: 20px;
         font-weight: bold;
         margin-bottom: 15px;
      }

      .counter-row {
         display: flex;
         justify-content: space-between;
         align-items: center;
         padding: 15px 0;
         border-bottom: 1px solid #eee;
      }

      .counter-row:last-child {
         border-bottom: none;
      }

      .counter-label {
         font-size: 16px;
      }

      .counter-subtext {
         font-size: 12px;
         color: #666;
         margin-top: 3px;
      }

      .counter-controls {
         display: flex;
         align-items: center;
         gap: 10px;
      }

      .counter-btn {
         width: 32px;
         height: 32px;
         line-height: 32px;
         text-align: center;
         background: #eee;
         border-radius: 50%;
         font-weight: bold;
         font-size: 22px;
         user-select: none;
         cursor: pointer;
         transition: background 0.3s;
      }

      .counter-btn:hover {
         background: #007aff;
         color: white;
      }

      .count-value {
         min-width: 30px;
         text-align: center;
         font-size: 16px;
         user-select: none;
      }

      #confirm-btn {
         width: 100%;
         padding: 14px;
         margin-top: 25px;
         border: none;
         background-color: #007aff;
         color: white;
         font-size: 18px;
         border-radius: 10px;
         cursor: pointer;
         user-select: none;
         transition: background-color 0.3s;
      }

      #confirm-btn:hover {
         background-color: #005bb5;
      }

      .search-trigger {
         padding: 4px 10px;
         background-color: #f1f3f5;
         color: #333;
         font-size: 13px;
         border-radius: 6px;
         font-weight: 500;
         border: 1px solid #ccc;
         margin-left: 6px;
      }

      .search-trigger:hover {
         cursor: pointer;
         background-color: #e9ecef;
      }

      #mobile-calendar:hover,
      #mobile-guest:hover {
         cursor: pointer;
      }
   </style>
</head>

<body>

   <main layout:fragment="content" class="main-container">

      <div class="search-bar-wrap">

         <div class="search-bar-inner">
            <select name="rg_name" id="region" class="search-input">
               <!-- ì²« ë²ˆì§¸: ì„œë²„ì—ì„œ ë„˜ì–´ì˜¨ ì„ íƒ ê°’ -->
               <option th:if="${rg_name != null}" th:value="${rg_name}" th:text="${rg_name}"></option>

               <!-- ë‚˜ë¨¸ì§€ ì§€ì—­ ë¦¬ìŠ¤íŠ¸ -->
               <option th:each="rg : ${regionList}" th:if="${rg.rg_name != rg_name}" th:value="${rg.rg_name}"
                  th:text="${rg.rg_name}"></option>
            </select>
            <div class="search-input" data-toggle="modal" data-target="#calendarModal">
               <i class="fas fa-list-alt"></i>
               <span id="checkTime">[[${checkTime}]]</span>
            </div>
            <div class="search-input" data-toggle="modal" data-target="#guestModal">
               <i class="fas fa-user"></i>
               <span id="check-people">[[${rm_person}]]</span>
            </div>
            <input type="hidden" name="checkTime" id="hiddenCheckTime" th:value="${checkTime}" />
            <input type="hidden" name="rm_person" id="hiddenRmPerson" th:value="${rm_person}" />
            <button type="button" class="search-btn">ê²€ìƒ‰</button>
         </div>

      </div>
      <!-- ë°˜ì‘í˜• ì „ìš© í—¤ë” -->
      <div class="mobile-header">
         <div class="mobile-header-top">
            <span class="place-name" style="font-weight: bold;">ì‹ ë¼ ì•„ì´íŒŒí¬ ëª°</span>
            <i class="fas fa-pen edit-icon" style="font-size: 10px;"></i>
         </div>
         <div class="mobile-header-bottom">
            <span id="mobile-calendar" data-toggle="modal" data-target="#calendarModal" th:text="${checkTime}"></span>
            <span> | </span>
            <span id="mobile-guest" data-toggle="modal" data-target="#guestModal">ì„±ì¸2</span>
            <span class="search-trigger" id="mobile">
               <i class="uil uil-search-alt"></i> ê²€ìƒ‰
            </span>
         </div>
         <div id="modal"
            style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index: 999999999;">
            <div id="modal-content" style="width:366px; margin:100px auto; background:#fff; padding:20px;">

            </div>
         </div>
      </div>
      <div class="mobile-sort-bar">
         <div class="sort-top">
            <div class="left-buttons">
               <select name="sort">
                  <option value="ì¶”ì²œìˆœ">ì¶”ì²œìˆœ</option>
                  <option value="ê°€ê²©ìˆœ">ê°€ê²©ìˆœ</option>
                  <option value="í‰ì ìˆœ">í‰ì ìˆœ</option>
                  <option value="ì„±ê¸‰ìˆœ">ì„±ê¸‰ìˆœ</option>
               </select>
               <button id="openModalBtn">ğŸ›  í•„í„°</button>

            </div>
            <div class="sort-bottom">
               <span id="mobile-loSize" class="count">ìˆ™ì†Œ [[${lodgingList.size()}]]ê°œ</span>
            </div>
         </div>
         <div class="right-map">
            <button type="button" class="kakao-map kakao-loadMap" data-toggle="modal" data-target="#kakaoMapModal">ğŸ—º
               ì§€ë„</button>
         </div>
      </div>
      <div class="row">
         <div id="search-find" class="search-box-area" style="position: relative; overflow: visible;">
            <!-- Ajaxë¡œ ë¶ˆëŸ¬ì˜¨ ë‚´ìš©ì´ ì—¬ê¸°ì— ë“¤ì–´ì˜´ -->
         </div>
         <div class="col-md-10 container-box">
            <div class="d-flex justify-content-between align-items-center mb-2" style="gap: 100px;">
               <div>
                  <h5 class="mb-0">ê²€ìƒ‰ê²°ê³¼</h5>
                  <small class="text-muted" id="lodging-size">ìˆ™ì†Œ [[${lodgingList.size()}]]ê°œ</small>
               </div>
               <div class="sort-options">
                  <label><input type="radio" name="sort" value="ì¶”ì²œìˆœ" checked> <span>ì¶”ì²œìˆœ</span></label>
                  <label><input type="radio" name="sort" value="í‰ì ìˆœ"> <span>í‰ì ìˆœ</span></label>
                  <label><input type="radio" name="sort" value="ê°€ê²©ìˆœ"> <span>ê°€ê²©ìˆœ</span></label>
                  <label><input type="radio" name="sort" value="ì„±ê¸‰ìˆœ"> <span>ì„±ê¸‰ìˆœ</span></label>
                  <label><input type="radio" name="sort" value="ê±°ë¦¬ìˆœ"> <span>ê±°ë¦¬ìˆœ</span></label>
               </div>
            </div>
            <div id="hotel_ajx">
               <!-- Ajaxë¡œ ìˆ™ì†Œ  ì²˜ìŒ ê²€ìƒ‰í•œ ë°ì´í„°ëŠ” ìˆê³  ë‹¤ìŒë¶€í„° ë°”ë€œ-->
               <div class="im" th:each="ld : ${lodgingList}">
                  <a href="#" class="card-link" th:data-ld-num="${ld.ld_num}" th:data-ld-region="${ld.ld_region}">
                     <div class="hotel-image">
                        <img class="poto" src="/resources/static/imgs/hotel.png" alt="í˜¸í…”1">
                     </div>
                     <div class="hotel-info">
                        <div class="hotel-up">
                           <div class="hotel-name" th:text="${ld.ld_name}"></div>
                           <div class="hotel-grade">
                              <img class="star" src="/resources/static/imgs/star.svg" alt="star">
                              <span class="review-score" th:text="${ld.avg_rating}"></span>
                              <span class="hotel-stars">Â· [[${ld.ld_rating}]]ì„±ê¸‰</span>
                           </div>
                           <div class="hotel-location">ì„œìš¸íŠ¹ë³„ì‹œ - ì ì‹¤ì—­ì—ì„œ 355m</div>
                        </div>
                        <div class="hotel-price">
                           <span class="price">[[${ld.min_price}]]ì›</span> /1ë°•
                        </div>
                     </div>
                  </a>
               </div>
            </div>

         </div>
      </div>
      <div class="modal" id="kakaoMapModal">
         <div class="modal-dialog">
            <div class="modal-content">
               <!-- Modal í—¤ë” -->
               <div class="modal-header">
                  <span>ì§€ë„ë³´ê¸°</span>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
               </div>
               <!-- Modal ë°”ë”” -->
               <div class="modal-body hotel-map-datail" id="map1">
               </div>
            </div>
         </div>
      </div>
      <div class="modal" id="calendarModal">
         <div class="modal-dialog">
            <div class="modal-content">
               <!-- Modal í—¤ë” -->
               <div class="modal-header">
                  <div>
                     <span id="start-date">ë‚ ì§œ ì„ íƒ</span> ~ <span id="end-date"></span>
                  </div>
                  <div class="nights" id="nights"></div>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
               </div>
               <!-- Modal ë°”ë”” -->
               <div class="modal-body">
                  <div class="calendar-wrapper">
                     <div id="calendar-grid" class="calendar-grid"></div>
                  </div>
               </div>
               <!-- Modal í‘¸í„° -->
               <div class="modal-footer justify-content-center">
                  <button type="button" class="apply-btn" onclick="applySelection()" data-dismiss="modal">ì ìš©í•˜ê¸°</button>
               </div>
            </div>
         </div>
      </div>
      <div class="modal" id="guestModal">
         <div class="modal-dialog">
            <div class="modal-content">
               <!-- Modal í—¤ë” -->
               <div class="modal-header">
                  <div>
                     <span>ì¸ì› ì„ íƒ</span>
                  </div>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
               </div>
               <!-- Modal ë°”ë”” -->
               <div class="modal-body">
                  <div>
                     <div class="counter-label">ì„±ì¸</div>
                     <div class="counter-subtext">ë§Œ 18ì„¸ ì´ìƒ</div>
                  </div>
                  <div class="counter-controls">
                     <div class="counter-btn" id="adult-minus">âˆ’</div>
                     <div class="count-value" id="adult-count">2</div>
                     <div class="counter-btn" id="adult-increase">+</div>
                  </div>
               </div>
               <!-- Modal í‘¸í„° -->
               <div class="modal-footer justify-content-center">
                  <button type="button" id="confirm-btn" data-dismiss="modal">ì ìš©í•˜ê¸°</button>
               </div>
            </div>
         </div>
      </div>
      <div class="modal" id="calendarModal">
         <div class="modal-dialog">
            <div class="modal-content">
               <!-- Modal í—¤ë” -->
               <div class="modal-header">
                  <div>
                     <span id="start-date">ë‚ ì§œ ì„ íƒ</span> ~ <span id="end-date"></span>
                  </div>
                  <div class="nights" id="nights"></div>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
               </div>
               <!-- Modal ë°”ë”” -->
               <div class="modal-body">
                  <div class="calendar-wrapper">
                     <div id="calendar-grid" class="calendar-grid"></div>
                  </div>
               </div>
               <!-- Modal í‘¸í„° -->
               <div class="modal-footer justify-content-center">
                  <button type="button" class="apply-btn" onclick="applySelection()" data-dismiss="modal">ì ìš©í•˜ê¸°</button>
               </div>
            </div>
         </div>
      </div>
      <div class="modal" id="guestModal">
         <div class="modal-dialog">
            <div class="modal-content">
               <!-- Modal í—¤ë” -->
               <div class="modal-header">
                  <div>
                     <span>ì¸ì› ì„ íƒ</span>
                  </div>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
               </div>
               <!-- Modal ë°”ë”” -->
               <div class="modal-body">
                  <div>
                     <div class="counter-label">ì„±ì¸</div>
                     <div class="counter-subtext">ë§Œ 18ì„¸ ì´ìƒ</div>
                  </div>
                  <div class="counter-controls">
                     <div class="counter-btn" id="adult-minus">âˆ’</div>
                     <div class="count-value" id="adult-count">2</div>
                     <div class="counter-btn" id="adult-increase">+</div>
                  </div>
               </div>
               <!-- Modal í‘¸í„° -->
               <div class="modal-footer justify-content-center">
                  <button type="button" id="confirm-btn" data-dismiss="modal">ì ìš©í•˜ê¸°</button>
               </div>
            </div>
         </div>
      </div>
      <script>
         function updateCardLinks() {
            const region = $('#region').val();
            const checkTime = $('#checkTime').text().trim();
            const people = $('#check-people').text().trim();
            const qR = encodeURIComponent(region);
            const qT = encodeURIComponent(checkTime);
            const qP = encodeURIComponent(people);

            $('.card-link').each(function () {
               const ld_num = $(this).data('ld-num');
               const ld_region = encodeURIComponent($(this).data('ld-region'));

               $(this).attr(
                  'href',
                  `/reserv?rg_name=${qR}&checkTime=${qT}&rm_person=${qP}&ld_num=${ld_num}&ld_region=${ld_region}`
               );
            });
         }
      </script>
      <script>
         $(document).on('click', ".filter-btn", function () {
            const section = $(this).parents('.section').find('.section-title').text().trim();
            if (section === 'ì„±ê¸‰') {
               let dataRating = $(this).data("rating");
               $this = $(`[data-rating=${dataRating}]`);
               $this.toggleClass("active")
            }
            if (section === 'í‰ì ') {
               let dataAvg = $(this).data("avg");
               $this = $(`[data-avg=${dataAvg}]`);

               $this.siblings().removeClass("active");
               $this.toggleClass("active")
            }
            if (section === 'ìˆ™ì†Œìœ í˜•') {
               let dataType = $(this).data("type");
               $this = $(`[data-type=${dataType}]`);
               $this.toggleClass("active")
            }
            getLodgingList();
         })
         $(document).on('click', '.name-search', function () {
            $(".search-ld-name").val($(this).siblings('.search-ld-name').val());
            getLodgingList();
         });
         $(".search-btn").on('click', function () {
            getLodgingList();
         })
         $(document).on('input', '.lodging-price', function () {
            $(".lodging-price").val($(this).val());
            getLodgingList();
         });

         $("[name = sort]").on('change', function () {
            let obj = { sort: $(this).val() }
            if ($(this).filter("select").length == 0) {
               $("select[name=sort]").val(obj.sort)
            } else {
               $("input[name=sort]").each(function () {
                  if ($(this).val() == obj.sort) {
                     $(this).prop("checked", true)
                  }
               })
            }
            getLodgingList(obj);
         })
         function getLodgingList(obj) {
            let ld_name = $(".search-ld-name").val();
            let ratings = [];
            $('.filter-btn.fillter-rating.active').each(function () {
               ratings.push($(this).data('rating'));
            });
            let avg = $('.filter-btn.fillter-avg.active').data('avg');
            let types = [];
            $('.filter-btn.fillter-type.active').each(function () {
               types.push($(this).data('type'));
            });
            let price = $(".lodging-price").val();
            const sort = obj && obj.sort ? obj.sort : $("[name=sort]:checked").val();
            const checkTime = $("#checkTime").text();
            const rm_person = $("#check-people").text();
            const rg_name = $("#region").val();
            let cri = {
               rg_name: rg_name,
               checkTime: checkTime,
               rm_person: rm_person,
               sort: sort,
               rating: ratings,
               avg: avg,
               type: types,
               price: price,
               ld_name: ld_name
            }
            $.ajax({
               url: '/searching/lodging',
               type: 'GET',
               data: cri,
               success: function (data) {
                  $('#hotel_ajx').html(data);
                  const lo_size = $("#lo-size").val();
                  $("#lodging-size").text("ìˆ™ì†Œ " + lo_size + "ê°œ");
                  $("#mobile-loSize").text("ìˆ™ì†Œ " + lo_size + "ê°œ");

                  updateCardLinks();
               },
            });
         }

         function toggleDetailAll() {
            $.ajax({
               url: '/searching/find',
               type: 'GET',
               success: function (data) {
                  $('#search-find').html(data);
               },
            });
         }

         $(document).ready(function () {
            toggleDetailAll();
            updateCardLinks();

            let lastScrollTop = 0;
            const searchBarWrap = document.querySelector('.search-bar-wrap');
            const mobileSortBar = document.querySelector('.mobile-sort-bar');
            const searchBoxArea = document.querySelector('.search-box-area');

            // ì´ˆê¸° ì§„ì… ì‹œ ìœ„ì¹˜ ë³´ì •
            if (searchBoxArea) searchBoxArea.style.transform = 'translateY(0px)';

            window.addEventListener('scroll', function () {
               const currentScroll = window.pageYOffset || document.documentElement.scrollTop;

               if (currentScroll === 0) {
                  // ë§¨ ìœ„ë¡œ ì˜¬ë¼ê°€ë©´ ì›ìœ„ì¹˜ (ì´ˆê¸° ìƒíƒœ ë³µê·€)
                  searchBarWrap.style.transform = 'translateY(0)';
                  searchBarWrap.style.opacity = '1';
                  if (mobileSortBar) mobileSortBar.style.transform = 'translateY(0)';
                  if (searchBoxArea) searchBoxArea.style.transform = 'translateY(0px)';
               } else if (currentScroll < lastScrollTop) {
                  // ìœ„ë¡œ ìŠ¤í¬ë¡¤ â†’ ë‹¤ì‹œ ë³´ì„
                  searchBarWrap.style.transform = 'translateY(0)';
                  searchBarWrap.style.opacity = '1';
                  if (mobileSortBar) mobileSortBar.style.transform = 'translateY(0)';
                  if (searchBoxArea) searchBoxArea.style.transform = 'translateY(80px)';
               } else {
                  // ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤ â†’ ìˆ¨ê¹€
                  searchBarWrap.style.transform = 'translateY(-100%)';
                  searchBarWrap.style.opacity = '0';
                  if (mobileSortBar) mobileSortBar.style.transform = 'translateY(-100%)';
                  if (searchBoxArea) searchBoxArea.style.transform = 'translateY(0)';
               }

               lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
            });
         });

         const today = new Date();
         today.setHours(0, 0, 0, 0);

         let selectedStart = null;
         let selectedEnd = null;

         function formatDate(date) {
            const y = date.getFullYear();
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            const w = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][date.getDay()];
            return `${y}.${m}.${d}(${w})`;
         }

         function createCalendar(year, month) {
            const $monthContainer = $('<div class="month"></div>');
            const $monthTitle = $('<h3></h3>').text(`${year}.${month + 1}`);
            const $daysGrid = $('<div class="days"></div>');

            const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            $.each(dayNames, (_, day) => {
               $daysGrid.append($('<div class="day-name"></div>').text(day));
            });

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);

            for (let i = 0; i < firstDay.getDay(); i++) {
               $daysGrid.append('<div></div>');
            }

            for (let d = 1; d <= lastDay.getDate(); d++) {
               const date = new Date(year, month, d);
               const $dayEl = $('<div class="day"></div>').text(d);

               if (date < today) {
                  $dayEl.addClass('disabled');
               } else {
                  $dayEl.on('click', function () {
                     selectDate(date);
                  });
               }

               $daysGrid.append($dayEl);
            }

            $monthContainer.append($monthTitle).append($daysGrid);
            $('#calendar-grid').append($monthContainer);
         }

         function renderCalendars() {
            const startYear = today.getFullYear();
            const startMonth = today.getMonth();

            for (let i = 0; i < 12; i++) {
               const year = startYear + Math.floor((startMonth + i) / 12);
               const month = (startMonth + i) % 12;
               createCalendar(year, month);
            }
         }

         function selectDate(date) {
            if (!selectedStart || (selectedStart && selectedEnd)) {
               selectedStart = date;
               selectedEnd = null;
            } else {
               if (date < selectedStart) {
                  selectedStart = date;
                  selectedEnd = null;
               } else {
                  const diff = (date - selectedStart) / (1000 * 60 * 60 * 24);
                  if (diff > 30) {
                     alert('ìµœëŒ€ 30ì¼ê¹Œì§€ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                     return;
                  }
                  selectedEnd = date;
               }
            }
            updateSelection();
         }

         function updateSelection() {
            $('.day').removeClass('selected in-range');

            if (selectedStart) {
               $('.month').each(function () {
                  const [year, month] = $(this).find('h3').text().split('.').map(Number);
                  $(this).find('.day').each(function () {
                     const dayNum = parseInt($(this).text());
                     const date = new Date(year, month - 1, dayNum);

                     if (selectedStart && !selectedEnd && date.getTime() === selectedStart.getTime()) {
                        $(this).addClass('selected');
                     }
                     if (selectedStart && selectedEnd) {
                        if (date.getTime() === selectedStart.getTime() || date.getTime() === selectedEnd.getTime()) {
                           $(this).addClass('selected');
                        } else if (date > selectedStart && date < selectedEnd) {
                           $(this).addClass('in-range');
                        }
                     }
                  });
               });
            }

            $('#start-date').text(selectedStart ? formatDate(selectedStart) : 'ë‚ ì§œ ì„ íƒ');
            $('#end-date').text(selectedEnd ? formatDate(selectedEnd) : '');
            if (selectedStart && selectedEnd) {
               const nights = (selectedEnd - selectedStart) / (1000 * 60 * 60 * 24);
               $('#nights').text(`${nights}ë°•`);
            } else {
               $('#nights').text('');
            }
         }

         function applySelection() {
            if (selectedStart && selectedEnd) {
               //ì•„ì´ë””ë¥¼ í•´ë‹¹ ì¸í’‹ ì•„ì´ë””ë¡œ í•˜ì‹œë©´ ë„ã…£ìš”
               $('#checkTime').text(`${formatDate(selectedStart)} ~ ${formatDate(selectedEnd)}`);
               $('#mobile-calendar').text(`${formatDate(selectedStart)} ~ ${formatDate(selectedEnd)}`);
               $('#hiddenCheckTime').val(`${formatDate(selectedStart)} ~ ${formatDate(selectedEnd)}`);

            } else {
               alert('ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
            }
         }

         $(document).ready(function () {
            renderCalendars();
         });
         $(function () {
            const $adultCount = $('#adult-count');
            const minAdult = 1;
            const maxAdult = 10;

            $('#adult-minus').click(function () {
               let val = parseInt($adultCount.text());
               if (val > minAdult) {
                  $adultCount.text(val - 1);
               }
            });

            $('#adult-increase').click(function () {
               let val = parseInt($adultCount.text());
               if (val < maxAdult) {
                  $adultCount.text(val + 1);
               }
            });

            $('#confirm-btn').click(function () {
               $('#check-people').text(`ì„±ì¸${$adultCount.text()}`);
               $('#mobile-guest').text(`ì„±ì¸${$adultCount.text()}`);
               $('#hiddenRmPerson').val(`ì„±ì¸${$adultCount.text()}`);
            });
         });         
      </script>
      <script>
         $("#modal-content").load("/searching/find");
         $("#openModalBtn").click(function () {
            $("#modal").show();

         });

         // ëª¨ë‹¬ ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸°
         $("#modal").click(function (e) {
            // í´ë¦­ëœ ëŒ€ìƒì´ #modal-contentê°€ ì•„ë‹Œ ê²½ìš°ë§Œ ë‹«ê¸°
            if (!$(e.target).closest("#modal-content").length) {
               $("#modal").hide();
            }
         });
  // kakao.maps.load(function () {
            //    // ì§€ë„ ì •ë³´ë¥¼ ë°°ì—´ë¡œ ê´€ë¦¬
            //    const mapData = [
            //       { id: 'map1', address: 'ê²½ê¸°ë„ ì•ˆì‚°ì‹œ ë‹¨ì›êµ¬ ì¤‘ì•™ëŒ€ë¡œ 869', lat: 0, lng: 0 }  // ì£¼ì†Œë¡œ ë³€ê²½
            //    ];

            //    // ê° ì§€ë„ ìƒì„±
            //    mapData.forEach((mapInfo) => {
            //       var container = document.getElementById(mapInfo.id);
            //       if (container) {  // í•´ë‹¹ IDì˜ divê°€ ìˆì„ ë•Œë§Œ ì§€ë„ ìƒì„±

            //          // ì£¼ì†Œë¡œ ì¢Œí‘œ ë³€í™˜
            //          var geocoder = new kakao.maps.services.Geocoder();
            //          geocoder.addressSearch(mapInfo.address, function (result, status) {
            //             if (status === kakao.maps.services.Status.OK) {
            //                // ì£¼ì†Œë¥¼ ì¢Œí‘œë¡œ ë³€í™˜í•œ ê²°ê³¼
            //                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

            //                // ì§€ë„ ì˜µì…˜
            //                var options = {
            //                   center: coords,  // ë³€í™˜ëœ ì¢Œí‘œë¡œ ì¤‘ì‹¬ì„ ì„¤ì •
            //                   level: 3
            //                };

            //                // ì§€ë„ ìƒì„±
            //                var map = new kakao.maps.Map(container, options);

            //                // ë§ˆì»¤ ìƒì„±
            //                var marker = new kakao.maps.Marker({
            //                   position: coords
            //                });
            //                marker.setMap(map);

            //                // í¬ê¸° ê°±ì‹  (í•„ìš” ì‹œ)
            //                setTimeout(() => map.relayout(), 100);
            //             } else {
            //                console.error("ì£¼ì†Œ ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            //             }
            //          });
            //       }
            //    });
            // });
      </script>
      <script>
         $(document).on('click', '.kakao-loadMap', function () {
            let region = [];
            $('.card-link').each(function () {
               //region.push($(this).data('ld-region'));
            });
            let ld_name=[];
            $('.hotel-name').each(function () {
               ld_name.push($(this).text());
            });
            console.log(ld_name)
            region.push("ì œì£¼íŠ¹ë³„ìì¹˜ë„ ì œì£¼ì‹œ ì¡°ì²œì ì‹ ë¶ë¡œ 470", "ì œì£¼íŠ¹ë³„ìì¹˜ë„ ì„œê·€í¬ì‹œ 1100ë¡œ 453-95")
            kakaoMapLoad(region,ld_name);
         });

         function kakaoMapLoad(addresses,ld_name) {

            var mapContainer = document.getElementById('map1'), // ì§€ë„ë¥¼ í‘œì‹œí•  div 
               mapOption = {
                  center: new kakao.maps.LatLng(33.450701, 126.570667), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
                  level: 3 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
               };

            // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤    
            var map = new kakao.maps.Map(mapContainer, mapOption);

            // ë§ˆì»¤ ì´ë¯¸ì§€ì˜ ì´ë¯¸ì§€ ì£¼ì†Œì…ë‹ˆë‹¤
            var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";

            var geocoder = new kakao.maps.services.Geocoder();
            for (let i = 0; i < addresses.length; i++) {

               geocoder.addressSearch(addresses[i], function (result, status) {

                  if (status === kakao.maps.services.Status.OK) {
                     // ì£¼ì†Œë¥¼ ì¢Œí‘œë¡œ ë³€í™˜í•œ ê²°ê³¼
                     var coords = new kakao.maps.LatLng(result[0].y, result[0].x);
                     // ì§€ë„ ì˜µì…˜
                     var options = {
                        center: coords,  // ë³€í™˜ëœ ì¢Œí‘œë¡œ ì¤‘ì‹¬ì„ ì„¤ì •
                        level: 3
                     };

                     // ë§ˆì»¤ ì´ë¯¸ì§€ì˜ ì´ë¯¸ì§€ í¬ê¸° ì…ë‹ˆë‹¤
                     var imageSize = new kakao.maps.Size(24, 35);

                     // ë§ˆì»¤ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤    
                     var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);
                     // ë§ˆì»¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                     var marker = new kakao.maps.Marker({
                        map: map, // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ì§€ë„
                        position: coords, // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ìœ„ì¹˜
                        title: addresses[i], // ë§ˆì»¤ì˜ íƒ€ì´í‹€, ë§ˆì»¤ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ íƒ€ì´í‹€ì´ í‘œì‹œë©ë‹ˆë‹¤
                        image: markerImage // ë§ˆì»¤ ì´ë¯¸ì§€ 
                     });
                     marker.myTitle = ld_name[i];
                     var iwContent = '<div class="marker-title">'+marker.myTitle +'</div>';
                     var infowindow = new kakao.maps.InfoWindow({
                           content :  iwContent // ì¸í¬ìœˆë„ìš°ì— í‘œì‹œí•  ë‚´ìš©
                     });
                     console.log(marker.myTitle);
                     // ë§ˆì»¤ì— mouseover ì´ë²¤íŠ¸ì™€ mouseout ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
                     // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¡œëŠ” í´ë¡œì €ë¥¼ ë§Œë“¤ì–´ ë“±ë¡í•©ë‹ˆë‹¤ 
                     // forë¬¸ì—ì„œ í´ë¡œì €ë¥¼ ë§Œë“¤ì–´ ì£¼ì§€ ì•Šìœ¼ë©´ ë§ˆì§€ë§‰ ë§ˆì»¤ì—ë§Œ ì´ë²¤íŠ¸ê°€ ë“±ë¡ë©ë‹ˆë‹¤
                     infowindow.open(map, marker);
                     $(".marker-title").parent().addClass('marker-title-div'); 
                  } else {
                     console.error("ì£¼ì†Œ ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                  }
                  
               });
            }         
         }
      </script>
   </main>
</body>

</html>