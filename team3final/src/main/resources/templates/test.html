<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <title>호텔 스타일 일정 선택</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap">
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 30px;
    }

    .calendar-wrapper {
      background: white;
      max-width: 700px;
      margin: auto;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .calendar-header {
      margin-bottom: 20px;
      font-size: 18px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 30px;
      max-height: 600px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .month {
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 10px;
      background: #fff;
    }

    .month h3 {
      text-align: center;
      margin: 0 0 10px;
    }

    .days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }

    .day,
    .day-name {
      text-align: center;
      padding: 8px 0;
    }

    .day-name {
      font-weight: bold;
      background-color: #f8f8f8;
    }

    .day.disabled {
      color: #ccc;
      pointer-events: none;
    }

    .day.selected {
      background-color: #007aff;
      color: white;
      border-radius: 10px;
    }

    .day.in-range {
      background-color: rgba(0, 122, 255, 0.3);
      border-radius: 10px;
    }

    .apply-btn {
      width: 100%;
      padding: 15px;
      background-color: #007aff;
      color: white;
      font-size: 16px;
      border: none;
      margin-top: 20px;
      border-radius: 10px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div class="calendar-wrapper">
    <div class="calendar-header">
      <div>
        <span id="start-date">날짜 선택</span> ~ <span id="end-date"></span>
      </div>
      <div class="nights" id="nights"></div>
    </div>
    <div id="calendar-grid" class="calendar-grid"></div>
    <button class="apply-btn" onclick="applySelection()">적용하기</button>
  </div>

  <script>
    const calendarGrid = document.getElementById('calendar-grid');
    const startDateEl = document.getElementById('start-date');
    const endDateEl = document.getElementById('end-date');
    const nightsEl = document.getElementById('nights');

    let selectedStart = null;
    let selectedEnd = null;

    const today = new Date();
    today.setHours(0, 0, 0, 0);

    function createCalendar(year, month) {
      const monthContainer = document.createElement('div');
      monthContainer.className = 'month';

      const monthTitle = document.createElement('h3');
      monthTitle.textContent = `${year}.${month + 1}`;
      monthContainer.appendChild(monthTitle);

      const daysGrid = document.createElement('div');
      daysGrid.className = 'days';

      const dayNames = ['일', '월', '화', '수', '목', '금', '토'];
      dayNames.forEach(day => {
        const dayEl = document.createElement('div');
        dayEl.className = 'day-name';
        dayEl.textContent = day;
        daysGrid.appendChild(dayEl);
      });

      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);

      for (let i = 0; i < firstDay.getDay(); i++) {
        const empty = document.createElement('div');
        daysGrid.appendChild(empty);
      }

      for (let d = 1; d <= lastDay.getDate(); d++) {
        const date = new Date(year, month, d);
        const dayEl = document.createElement('div');
        dayEl.className = 'day';
        dayEl.textContent = d;

        if (date < today) {
          dayEl.classList.add('disabled');
        } else {
          dayEl.addEventListener('click', () => selectDate(date, dayEl));
        }

        daysGrid.appendChild(dayEl);
      }

      monthContainer.appendChild(daysGrid);
      calendarGrid.appendChild(monthContainer);
    }

    function renderCalendars() {
      let startYear = today.getFullYear();
      let startMonth = today.getMonth(); // 0부터 시작
      for (let i = 0; i < 12; i++) {
        const year = startYear + Math.floor((startMonth + i) / 12);
        const month = (startMonth + i) % 12;
        createCalendar(year, month);
      }
    }

    function selectDate(date, el) {
      if (!selectedStart || (selectedStart && selectedEnd)) {
        selectedStart = date;
        selectedEnd = null;
      } else {
        if (date < selectedStart) {
          selectedStart = date;
          selectedEnd = null;
        } else {
          const diff = (date - selectedStart) / (1000 * 60 * 60 * 24);
          if (diff > 30) {
            alert('최대 30일까지만 선택 가능합니다.');
            return;
          }
          selectedEnd = date;
        }
      }
      updateSelection();
    }

    function updateSelection() {
      document.querySelectorAll('.day').forEach(day => {
        day.classList.remove('selected', 'in-range');
      });

      if (selectedStart) {
        document.querySelectorAll('.day').forEach(day => {
          const parent = day.closest('.month');
          const [year, month] = parent.querySelector('h3').textContent.split('.').map(Number);
          const dayNum = Number(day.textContent);
          const date = new Date(year, month - 1, dayNum);

          if (selectedStart && !selectedEnd && date.getTime() === selectedStart.getTime()) {
            day.classList.add('selected');
          }
          if (selectedStart && selectedEnd) {
            if (date.getTime() === selectedStart.getTime() || date.getTime() === selectedEnd.getTime()) {
              day.classList.add('selected');
            } else if (date > selectedStart && date < selectedEnd) {
              day.classList.add('in-range');
            }
          }
        });
      }

      startDateEl.textContent = selectedStart ? formatDate(selectedStart) : '날짜 선택';
      endDateEl.textContent = selectedEnd ? formatDate(selectedEnd) : '';

      if (selectedStart && selectedEnd) {
        const nights = (selectedEnd - selectedStart) / (1000 * 60 * 60 * 24);
        nightsEl.textContent = `${nights}박`;
      } else {
        nightsEl.textContent = '';
      }
    }

    function formatDate(date) {
      const y = date.getFullYear();
      const m = String(date.getMonth() + 1).padStart(2, '0');
      const d = String(date.getDate()).padStart(2, '0');
      const w = ['일', '월', '화', '수', '목', '금', '토'][date.getDay()];
      return `${y}.${m}.${d}(${w})`;
    }

    function applySelection() {
      if (selectedStart && selectedEnd) {
        alert(`${formatDate(selectedStart)} ~ ${formatDate(selectedEnd)}`);
      } else {
        alert('날짜를 선택해주세요.');
      }
    }

    renderCalendars();
  </script>
</body>

</html>